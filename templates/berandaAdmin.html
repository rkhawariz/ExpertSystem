<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link
      rel="icon"
      type="image/x-icon"
      href="../static/img/LH+Logo.png"
    />
    <link
      href="../static/vendor/fontawesome-free/css/all.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet"
    />

    <link href="../static/css/sb-admin-2.css" rel="stylesheet" />

    <script
      src="https://use.fontawesome.com/releases/v6.3.0/js/all.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <title>Dashboard - LambungHealth</title>
  </head>
  <body>
    {% extends 'layoutDashboard.html' %} {% block content %}
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
      <h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
    </div>

    <div class="row">
      <!-- Daftar Penyakit Card -->
      <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-danger shadow h-100 py-2">
          <div class="card-body">
            <div class="row no-gutters align-items-center">
              <div class="col mr-2">
                <div
                  class="text-xs font-weight-bold text-danger text-uppercase mb-1"
                >
                  Daftar Penyakit
                </div>
                <div class="h5 mb-0 font-weight-bold text-gray-800">
                  {{ total_penyakit }}
                </div>
              </div>
              <div class="col-auto">
                <i class="fas fa-file-medical fa-2x text-gray-300"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Daftar Gejala Card -->
      <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-success shadow h-100 py-2">
          <div class="card-body">
            <div class="row no-gutters align-items-center">
              <div class="col mr-2">
                <div
                  class="text-xs font-weight-bold text-success text-uppercase mb-1"
                >
                  Daftar Gejala
                </div>
                <div class="h5 mb-0 font-weight-bold text-gray-800">
                  {{ total_gejala }}
                </div>
              </div>
              <div class="col-auto">
                <i class="fas fa-book-medical fa-2x text-gray-300"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Total Diagnosa Card -->
      <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-info shadow h-100 py-2">
          <div class="card-body">
            <div class="row no-gutters align-items-center">
              <div class="col mr-2">
                <div
                  class="text-xs font-weight-bold text-info text-uppercase mb-1"
                >
                  Total Diagnosa
                </div>
                <div class="row no-gutters align-items-center">
                  <div class="col-auto">
                    <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">
                      {{ total_diagnosa }}
                    </div>
                  </div>
                  <div class="col">
                    <div class="progress progress-sm mr-2">
                      <div
                        class="progress-bar bg-info"
                        role="progressbar"
                        style="width: 50%"
                        aria-valuenow="50"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-auto">
                <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Total User Card -->
      <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
          <div class="card-body">
            <div class="row no-gutters align-items-center">
              <div class="col mr-2">
                <div
                  class="text-xs font-weight-bold text-warning text-uppercase mb-1"
                >
                  Total User
                </div>
                <div class="h5 mb-0 font-weight-bold text-gray-800">
                  {{ total_users }}
                </div>
              </div>
              <div class="col-auto">
                <i class="fas fa-clipboard-user fa-2x text-gray-300"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <div class="row d-flex align-items-stretch">
      <!-- Statistik Diagnosa -->
      <div class="col-xl-7 col-lg-5 d-flex">
        <div class="card shadow mb-4 w-100">
          <div
            class="card-header py-3 d-flex flex-row align-items-center justify-content-between"
          >
            <h6 style="color: #41513b" class="m-0 font-weight-bold">
              Statistik Hasil Diagnosa Per Bulan
            </h6>
          </div>
          <div class="card-body">
            <div class="chart-area">
              <canvas id="myAreaChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    
      <!-- Statistik Diagnosa Penyakit -->
      <div class="col-xl-5 col-lg-5 d-flex">
        <div class="card shadow mb-4 w-100">
          <div class="card-header py-3">
            <h6 style="color: #41513b" class="m-0 font-weight-bold">
              Statistik Penyakit Terdiagnosa
            </h6>
          </div>
          <div class="card-body">
            <canvas id="pieChartPenyakit"></canvas>
          </div>
        </div>
      </div>
      <div class="col-xl-5 col-lg-4 d-flex">
        <div class="card shadow mb-4 w-100">
          <div class="card-header py-3">
            <h6 style="color: #41513b" class="m-0 font-weight-bold">
              Statistik Diagnosa Berdasarkan Jenis Kelamin
            </h6>
          </div>
          <div class="card-body">
            <canvas id="genderChart"></canvas>
          </div>
        </div>
      </div>
      <div class="col-xl-7 col-lg-2 d-flex">
        <div class="card shadow mb-4 w-100">
          <div class="card-header py-3">
            <h6 style="color: #41513b" class="m-0 font-weight-bold">
              Statistik Usia Pasien Terdiagnosa
            </h6>
          </div>
          <div class="card-body">
            <canvas id="usiaChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script>
                  document.addEventListener('DOMContentLoaded', function () {
                    const ctx = document.getElementById('myAreaChart').getContext('2d');
                    const labels = {{ labels|tojson }};
                    const data = {{ data|tojson }};

                    const myAreaChart = new Chart(ctx, {
                      type: 'line',
                      data: {
                        labels: labels, // Bulan
                        datasets: [{
                          label: 'Jumlah Diagnosa',
                          data: data, // Data Diagnosa
                          borderColor: 'rgba(75, 192, 192, 1)',
                          backgroundColor: 'rgba(75, 192, 192, 0.2)',
                          borderWidth: 2,
                          tension: 0.4,
                          pointRadius: 5,
                          pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                        }]
                      },
                      options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                          legend: {
                            display: true,
                            position: 'top'
                          },
                          tooltip: {
                            callbacks: {
                              label: function(context) {
                                return `${context.raw} Diagnosa`;
                              }
                            }
                          }
                        },
                        scales: {
                          x: {
                            title: {
                              display: true,
                              text: 'Bulan'
                            }
                          },
                          y: {
                            title: {
                              display: true,
                              text: 'Jumlah Diagnosa'
                            },
                            beginAtZero: true,

                          }
                        }
                      }
                    });
                  });

                  const penyakitLabels = {{ penyakit_labels | tojson }};
        const penyakitData = {{ penyakit_data | tojson }};

        const ctx = document.getElementById('pieChartPenyakit').getContext('2d');
new Chart(ctx, {
  type: 'pie',
  data: {
    labels: penyakitLabels,
    datasets: [{
      data: penyakitData,
      backgroundColor: [
        '#4e73df', 
        '#1cc88a',
        '#36b9cc', 
        '#f6c23e', 
        '#e74a3b',
        '#858796', 
      ],
      hoverBackgroundColor: [
        '#2e59d9',
        '#17a673', 
        '#2c9faf', 
        '#f4b619',
        '#e02d1b', 
        '#6c757d',
      ],
      hoverBorderColor: 'rgba(234, 236, 244, 1)',
    }],
  },
  options: {
    plugins: {
      legend: {
        display: true,
        position: 'bottom',
        labels: {
          usePointStyle: true,  
          pointStyle: 'circle', 
          boxWidth: 10,       
          padding: 15          
        }
      },
      tooltip: {
        callbacks: {
          label: function(tooltipItem) {
            const label = penyakitLabels[tooltipItem.dataIndex];
            const value = penyakitData[tooltipItem.dataIndex];
            return `${label}: ${value}`;
          }
        }
      }
    }
  }
});

    const usiaLabels = {{ usia_labels|tojson }};
    const usiaData = {{ usia_data|tojson }};

    const usiaCtx = document.getElementById('usiaChart').getContext('2d');
    new Chart(usiaCtx, {
        type: 'bar',
        data: {
            labels: usiaLabels,
            datasets: [{
                label: 'Distribusi Usia Pasien',
                data: usiaData,
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false },
                
            },
            scales: {
                y: { beginAtZero: true }
            }
        }
    });

    const genderCtx = document.getElementById('genderChart').getContext('2d');
    const genderChart = new Chart(genderCtx, {
        type: 'pie',
        data: {
            labels: {{ gender_labels|tojson }},
            datasets: [{
                label: 'Jumlah Diagnosa',
                data: {{ gender_data|tojson }},
                backgroundColor: [
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(255, 99, 132, 0.2)',
                ],
                borderColor: [
                    'rgba(75, 192, 192, 1)',
                    'rgba(255, 99, 132, 1)',
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true
                }
            }
        }
    });
      </script>
      {% endblock %}
    </div>
  </body>
</html>
